# yandex_praktikum_git_project 
Репозиторий для самостоятельного задания к спринту "Командная строка / Git" от Яндекс Практикума
________________________________________
# Проект: Обучение с учителем: качество модели

## Описание проекта

Интернет-магазин «В один клик» продаёт разные товары: для детей, для дома, мелкую бытовую технику, косметику и даже продукты. Отчёт магазина за прошлый период показал, что активность покупателей начала снижаться. Привлекать новых клиентов уже не так эффективно: о магазине и так знает большая часть целевой аудитории. Возможный выход — удерживать активность постоянных клиентов. Сделать это можно с помощью персонализированных предложений.

«В один клик» — современная компания, поэтому её руководство не хочет принимать решения просто так — только на основе анализа данных и бизнес-моделирования. У компании есть небольшой отдел цифровых технологий, и вам предстоит побыть в роли стажёра в этом отделе.

Итак, вашему отделу поручили разработать решение, которое позволит персонализировать предложения постоянным клиентам, чтобы увеличить их покупательскую активность.
________________________________________
## Описание данных

**market_file.csv**

Таблица, которая содержит данные о поведении покупателя на сайте, о коммуникациях с покупателем и его продуктовом поведении.

- id — номер покупателя в корпоративной базе данных.
- Покупательская активность — рассчитанный класс покупательской активности (целевой признак): «снизилась» или «прежний уровень».
- Тип сервиса — уровень сервиса, например «премиум» и «стандарт».
- Разрешить сообщать — информация о том, можно ли присылать покупателю дополнительные предложения о товаре. Согласие на это даёт покупатель.
- Маркет_актив6мес — среднемесячное значение маркетинговых коммуникаций компании, которое приходилось на покупателя за последние 6 месяцев. Это значение показывает, какое число рассылок, звонков, показов рекламы и прочего приходилось на клиента.
- Маркет_актив_тек_мес — количество маркетинговых коммуникаций в текущем месяце.
- Длительность — значение, которое показывает, сколько дней прошло с момента регистрации покупателя на сайте.
- Акционные_покупки — среднемесячная доля покупок по акции от общего числа покупок за последние 6 месяцев.
- Популярная_категория — самая популярная категория товаров у покупателя за последние 6 месяцев.
- Средний_просмотр_категорий_за_визит — показывает, сколько в среднем категорий покупатель просмотрел за визит в течение последнего месяца.
- Неоплаченные_продукты_штук_квартал — общее число неоплаченных товаров в корзине за последние 3 месяца.
- Ошибка_сервиса — число сбоев, которые коснулись покупателя во время посещения сайта.
- Страниц_за_визит — среднее количество страниц, которые просмотрел покупатель за один визит на сайт за последние 3 месяца.

**market_money.csv**

Таблица с данными о выручке, которую получает магазин с покупателя, то есть сколько покупатель всего потратил за период взаимодействия с сайтом.

id — номер покупателя в корпоративной базе данных.
Период — название периода, во время которого зафиксирована выручка. Например, 'текущий_месяц' или 'предыдущий_месяц'.
Выручка — сумма выручки за период.

**market_time.csv**

Таблица с данными о времени (в минутах), которое покупатель провёл на сайте в течение периода.

- id — номер покупателя в корпоративной базе данных.
- Период — название периода, во время которого зафиксировано общее время.
- минут — значение времени, проведённого на сайте, в минутах.

**money.csv**

Таблица с данными о среднемесячной прибыли покупателя за последние 3 месяца: какую прибыль получает магазин от продаж каждому покупателю.

- id — номер покупателя в корпоративной базе данных.
- Прибыль — значение прибыли.
________________________________________


## Подход к решению поставленной задачи заранее сформирован заказчиком:
1.	Нужно промаркировать уровень финансовой активности постоянных покупателей. В компании принято выделять два уровня активности: «снизилась», если клиент стал покупать меньше товаров, и «прежний уровень».
2.	Нужно собрать данные по клиентам по следующим группам:
    - Признаки, которые описывают коммуникацию сотрудников компании с клиентом.
    - Признаки, которые описывают продуктовое поведение покупателя (например, какие товары покупает и как часто).
    - Признаки, которые описывают покупательское поведение клиента (например, сколько тратил в магазине).
    - Признаки, которые описывают поведение покупателя на сайте (например, как много страниц просматривает и сколько времени проводит на сайте).

В исследование нужно включить дополнительные данные финансового департамента о прибыльности клиента: какой доход каждый покупатель приносил компании за последние три месяца.
________________________________________
## Цели исследования:
1.	Изучить имеющиеся данные и подготовить их для дальнейшего обучения моделей
2.	Разработать такую модель, которая предскажет вероятность снижения покупательской активности клиента в следующие три месяца
3.	Используя данные модели и данные о прибыльности клиентов, выделить сегменты покупателей и разработать для них персонализированные предложения, чтобы увеличить их покупательскую активность
________________________________________
## Поставленная задача:
Задачей данного проекта была построение модели, которая бы предсказала уменьшение покупательской активности пользователей интернет-магазина "В один клик".

Другая задача стояла это исследование выбранного сегмента пользователей.
________________________________________
## В рамках исследования были проделаны следующие шаги.
### Загрузка данных

Исходными данными для исследования были четыре отдельных csv файла:
- с данными о поведении покупателя на сайте, коммуникации с ним и его продуктовом поведении.
- с данными о выручке, которую получает магазин с покупателя за период
- с данными о времени (в минутах), которое покупатель провёл на сайте в течение периода
- данными о среднемесячной прибыли покупателя за последние 3 месяца: какую прибыль получает магазин от продаж каждому покупателю Данные были загружены в датафреймы библиотеки pandas.

### Предобработка данных

Исходные данные оказались хорошего качества, но тем не менее они требовали проведения некоторых работ перед началом анализа:
- стандартизация имен признаков. Наименования были оставлены на кириллице, но пробелы были заменены на землю.
- приведение типов данных. Некоторые числовые значения были считаны как строковые.
- обработка дублей. Если не учитывать колонку с уникальным идентификатором, то в датасете **market_file** было найдено 11 дублей. Дубли было решено оставить.
- обработка пропусков. Пропусков в данных не было найдено.

### Исследовательский анализ данных

   На этом этапе были построены диаграммы распределения всех признаков. Отметим, что график распределения признака **Акционные_покупки** явно выделял две группы пользователей поэтому признак был превращен в категориальный.
    
### Корреляционный анализ данных

   Целевым признаком является **Покупательская_активность** и вот список полей, которые имеют хоть корреляцию с ним: маркет_актив_6_мес, акционные_покупки, средний_просмотр_категорий_за_визит, неоплаченные_продукты_штук_квартал, страниц_за_визит, выручка_препредыдущий_месяц, минут_предыдущий_месяц, минут_текущий_месяц.

   Так же график показал сильную зависимость между целевым признаком и id так что в дальнейшем при подготовке данных к обучению модели признак идентификатор был удален. Сильной корреляции между другими признаками не было выявлено поэтому все остальные признаки были оставлены в датасете.

### Объединение таблиц

   Датасеты **market_file, market_money, market_time** были объединены в один датафрейм.

### Обучение модели

   С использованием пайпланов из библиотеки **sklearn** были обучены модели **KNeighborsClassifier(), DecisionTreeClassifier(), LogisticRegression() и SVC().** При обучении моделей средствами пайплана перебирались некоторое количество гиперпараметров моделей с целью нахождения модели, которая даст лучший результат.
    
   По результатам обучения лучшей стала модель **LogisticRegression(C=2, penalty='l1', random_state=42, solver='liblinear').** Метрика **roc_auc для тренировочной выборки 0.90** для **тестовой 0.92.** Удивительно, но значения метрики имеют такой низкий разброс. И даже наличие дисбаланса в целевом признаке не помешало получить значение метрики **f1=0.90.**

### Анализ важности признаков

   Если коротко, то самыми важными оказались признаки, связанные с количеством времени, которое покупатель проводит на маркетплейсе. А наименее важными, категории товаров, которые интересовали пользователи и коммуникации с пользователем.
    
   Кажется что все эти маркетинговые привлечения и спам на почту не помогают маркетплейсу. Важно лишь заставить пользователя проводить на сайте как можно больше времени и продажи вырастут.

### Сегментация пользователей

   Для анализа пользователей был выбран сегмент пользователей часто покупающих по скидке и в то же время имеющих высокую вероятность снижения покупательской активности. Мое предложение по увеличение активности этого сегмента покупателей это таргетированная настройка главной страницы маркетплейса. А также более частое обновление скидок на главной странице. Пользователь не хочет ходить по страницам, он хочет видеть все предложения в одном месте.
